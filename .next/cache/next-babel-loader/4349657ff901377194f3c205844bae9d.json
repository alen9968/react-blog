{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Date$now from \"@babel/runtime-corejs2/core-js/date/now\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/zhangxuecai/Projects/react-blog/pages/_app.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { Provider as ReduxProvider } from 'react-redux';\nimport App from 'next/app';\nimport createStore from '../redux/createStore';\nimport withRedux from 'next-redux-wrapper';\nimport HeadMeta from '../components/head';\nimport Nav from '../components/nav';\nimport Foot from '../components/foot';\nimport loginState from '../http/sessions';\nimport getPublicData from '../http';\nimport { myNotification } from '../http/self';\nimport { bindShortcuts } from '../utils';\nimport request, { getApiRoot } from '../utils/request';\nimport { isMobile } from \"../utils\";\nimport '../styles/main.scss';\nimport 'antd/dist/antd.css';\n\nvar MyApp =\n/*#__PURE__*/\nfunction (_App) {\n  _inherits(MyApp, _App);\n\n  function MyApp() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MyApp);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MyApp)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      user: 'hello',\n      isMobile: false\n    });\n\n    return _this;\n  }\n\n  _createClass(MyApp, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var props = this.props;\n      var store = props.store;\n      window.STORE = store;\n      window.DISPATCH = store.dispatch;\n      bindShortcuts();\n      request.getApiRoot().then(function () {\n        store.dispatch(getPublicData()); //store.dispatch(loginState()).then(() => store.dispatch(myNotification()))\n      })[\"finally\"](function () {\n        _this2.setState({\n          initializing: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Component = _this$props.Component,\n          pageProps = _this$props.pageProps,\n          store = _this$props.store;\n      return __jsx(ReduxProvider, {\n        store: store,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, __jsx(HeadMeta, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }), __jsx(Nav, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        style: {\n          position: 'relative'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }, __jsx(Component, _extends({}, pageProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }))), __jsx(Foot, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(_ref) {\n        var Component, ctx, pageProps, initialNow;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                Component = _ref.Component, ctx = _ref.ctx;\n\n                // ctx 报错\n                if (false) {\n                  global.navigator = {};\n                  global.navigator.languages = {};\n                  global.location = {};\n                } // const { req: { headers: { cookie } } } = ctx\n                // const locale = cookie.locale || 'zh'\n\n\n                if (!Component.getInitialProps) {\n                  _context.next = 8;\n                  break;\n                }\n\n                _context.next = 5;\n                return Component.getInitialProps(ctx);\n\n              case 5:\n                _context.t0 = _context.sent;\n                _context.next = 9;\n                break;\n\n              case 8:\n                _context.t0 = {};\n\n              case 9:\n                pageProps = _context.t0;\n                initialNow = _Date$now();\n                return _context.abrupt(\"return\", {\n                  pageProps: pageProps,\n                  initialNow: initialNow\n                });\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function getInitialProps(_x) {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return MyApp;\n}(App);\n\nexport default withRedux(createStore)(MyApp);","map":{"version":3,"sources":["/Users/zhangxuecai/Projects/react-blog/pages/_app.js"],"names":["React","Provider","ReduxProvider","App","createStore","withRedux","HeadMeta","Nav","Foot","loginState","getPublicData","myNotification","bindShortcuts","request","getApiRoot","isMobile","MyApp","user","props","store","window","STORE","DISPATCH","dispatch","then","setState","initializing","Component","pageProps","position","ctx","global","navigator","languages","location","getInitialProps","initialNow"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAQ,IAAIC,aAArB,QAA0C,aAA1C;AACA,OAAOC,GAAP,MAAgB,UAAhB;AACA,OAAOC,WAAP,MAAwB,sBAAxB;AACA,OAAOC,SAAP,MAAsB,oBAAtB;AACA,OAAOC,QAAP,MAAqB,oBAArB;AACA,OAAOC,GAAP,MAAgB,mBAAhB;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,OAAOC,aAAP,MAA0B,SAA1B;AACA,SAAUC,cAAV,QAAgC,cAAhC;AACA,SAAUC,aAAV,QAA+B,UAA/B;AACA,OAAOC,OAAP,IAAkBC,UAAlB,QAAqC,kBAArC;AACA,SAASC,QAAT,QAAyB,UAAzB;AACA,OAAO,qBAAP;AACA,OAAO,oBAAP;;IAGMC,K;;;;;;;;;;;;;;;;;;4DACI;AACNC,MAAAA,IAAI,EAAE,OADA;AAENF,MAAAA,QAAQ,EAAE;AAFJ,K;;;;;;;wCAoBY;AAAA;;AAAA,UACVG,KADU,GACA,IADA,CACVA,KADU;AAAA,UAEVC,KAFU,GAEAD,KAFA,CAEVC,KAFU;AAGlBC,MAAAA,MAAM,CAACC,KAAP,GAAeF,KAAf;AACAC,MAAAA,MAAM,CAACE,QAAP,GAAkBH,KAAK,CAACI,QAAxB;AACAX,MAAAA,aAAa;AACbC,MAAAA,OAAO,CACJC,UADH,GAEGU,IAFH,CAEQ,YAAM;AACVL,QAAAA,KAAK,CAACI,QAAN,CAAeb,aAAa,EAA5B,EADU,CAEV;AACF,OALF,aAMW,YAAM;AACb,QAAA,MAAI,CAACe,QAAL,CAAc;AAAEC,UAAAA,YAAY,EAAE;AAAhB,SAAd;AACD,OARH;AASD;;;6BAEQ;AAAA,wBACiC,KAAKR,KADtC;AAAA,UACCS,SADD,eACCA,SADD;AAAA,UACYC,SADZ,eACYA,SADZ;AAAA,UACuBT,KADvB,eACuBA,KADvB;AAGP,aACE,MAAC,aAAD;AAAe,QAAA,KAAK,EAAEA,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE,MAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,EAGE;AAAK,QAAA,KAAK,EAAE;AAAEU,UAAAA,QAAQ,EAAE;AAAZ,SAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,SAAD,eAAeD,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADF,CAHF,EAME,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QANF,CADF;AAUD;;;;;;;;;;;;AA5C8BD,gBAAAA,S,QAAAA,S,EAAWG,G,QAAAA,G;;AACxC;AACA,2BAAmC;AACjCC,kBAAAA,MAAM,CAACC,SAAP,GAAmB,EAAnB;AACAD,kBAAAA,MAAM,CAACC,SAAP,CAAiBC,SAAjB,GAA6B,EAA7B;AACAF,kBAAAA,MAAM,CAACG,QAAP,GAAkB,EAAlB;AACD,iB,CACD;AACA;;;qBACkBP,SAAS,CAACQ,e;;;;;;uBAAwBR,SAAS,CAACQ,eAAV,CAA0BL,GAA1B,C;;;;;;;;8BAAiC,E;;;AAA/EF,gBAAAA,S;AACAQ,gBAAAA,U,GAAa,W;iDACZ;AAAER,kBAAAA,SAAS,EAATA,SAAF;AAAaQ,kBAAAA,UAAU,EAAVA;AAAb,iB;;;;;;;;;;;;;;;;;;;EAlBSjC,G;;AAsDpB,eAAeE,SAAS,CAACD,WAAD,CAAT,CAAuBY,KAAvB,CAAf","sourcesContent":["import React from 'react'\nimport { Provider as ReduxProvider } from 'react-redux'\nimport App from 'next/app'\nimport createStore from '../redux/createStore'\nimport withRedux from 'next-redux-wrapper'\nimport HeadMeta from '../components/head'\nimport Nav from '../components/nav'\nimport Foot from '../components/foot'\nimport loginState from '../http/sessions'\nimport getPublicData from '../http'\nimport {  myNotification } from '../http/self'\nimport {  bindShortcuts } from '../utils'\nimport request, { getApiRoot  } from '../utils/request'\nimport { isMobile } from '~/utils'\nimport '../styles/main.scss'\nimport 'antd/dist/antd.css'\n\n\nclass MyApp extends App {\n  state = {\n    user: 'hello',\n    isMobile: false\n  }\n\n\n  static async getInitialProps({ Component, ctx }) {\n    // ctx 报错\n    if (typeof window === 'undefined') {\n      global.navigator = {}\n      global.navigator.languages = {}\n      global.location = {}\n    }\n    // const { req: { headers: { cookie } } } = ctx\n    // const locale = cookie.locale || 'zh'\n    const pageProps = Component.getInitialProps ? await Component.getInitialProps(ctx) : {}\n    const initialNow = Date.now()\n    return { pageProps, initialNow }\n  }\n\n  componentDidMount() {\n    const { props } = this\n    const { store } = props\n    window.STORE = store\n    window.DISPATCH = store.dispatch\n    bindShortcuts()\n    request\n      .getApiRoot()\n      .then(() => {\n        store.dispatch(getPublicData())\n        //store.dispatch(loginState()).then(() => store.dispatch(myNotification()))\n     })\n      .finally(() => {\n        this.setState({ initializing: false })\n      })\n  }\n\n  render() {\n    const { Component, pageProps, store } = this.props\n\n    return (\n      <ReduxProvider store={store}>\n        <HeadMeta />\n        <Nav />\n        <div style={{ position: 'relative' }}>\n          <Component {...pageProps} />\n        </div>\n        <Foot />\n      </ReduxProvider>\n    )\n  }\n}\n\nexport default withRedux(createStore)(MyApp)\n\n\n"]},"metadata":{},"sourceType":"module"}