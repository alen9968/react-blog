{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _Date$now from \"@babel/runtime-corejs2/core-js/date/now\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/zhangxuecai/Projects/react-blog/pages/_app.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { Provider as ReduxProvider } from 'react-redux';\nimport App from 'next/app';\nimport createStore from '../redux/createStore';\nimport withRedux from 'next-redux-wrapper';\nimport HeadMeta from '../components/head';\nimport Nav from '../components/nav';\nimport Foot from '../components/foot';\nimport loginState from '../http/sessions';\nimport getPublicData from '../http';\nimport { myNotification } from '../http/self';\nimport { bindShortcuts } from '../utils';\nimport request, { getApiRoot } from '../utils/request';\nimport { isMobile } from \"../utils\";\nimport '../styles/main.scss';\nimport 'antd/dist/antd.css';\n\nclass MyApp extends App {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      user: 'hello',\n      isMobile: false\n    });\n  }\n\n  static async getInitialProps({\n    Component,\n    ctx\n  }) {\n    // ctx 报错\n    if (true) {\n      global.navigator = {};\n      global.navigator.languages = {};\n      global.location = {};\n    } // const { req: { headers: { cookie } } } = ctx\n    // const locale = cookie.locale || 'zh'\n\n\n    const pageProps = Component.getInitialProps ? await Component.getInitialProps(ctx) : {};\n\n    const initialNow = _Date$now();\n\n    return {\n      pageProps,\n      initialNow\n    };\n  }\n\n  componentDidMount() {\n    const {\n      props\n    } = this;\n    const {\n      store\n    } = props;\n    window.STORE = store;\n    window.DISPATCH = store.dispatch;\n    bindShortcuts();\n    request.getApiRoot().then(() => {\n      store.dispatch(getPublicData()); //store.dispatch(loginState()).then(() => store.dispatch(myNotification()))\n    }).finally(() => {\n      this.setState({\n        initializing: false\n      });\n    });\n  }\n\n  render() {\n    const {\n      Component,\n      pageProps,\n      store\n    } = this.props;\n    return __jsx(ReduxProvider, {\n      store: store,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, __jsx(HeadMeta, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }), __jsx(Nav, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      style: {\n        position: 'relative'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, __jsx(Component, _extends({}, pageProps, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }))), __jsx(Foot, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default withRedux(createStore)(MyApp);","map":{"version":3,"sources":["/Users/zhangxuecai/Projects/react-blog/pages/_app.js"],"names":["React","Provider","ReduxProvider","App","createStore","withRedux","HeadMeta","Nav","Foot","loginState","getPublicData","myNotification","bindShortcuts","request","getApiRoot","isMobile","MyApp","user","getInitialProps","Component","ctx","global","navigator","languages","location","pageProps","initialNow","componentDidMount","props","store","window","STORE","DISPATCH","dispatch","then","finally","setState","initializing","render","position"],"mappings":";;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAQ,IAAIC,aAArB,QAA0C,aAA1C;AACA,OAAOC,GAAP,MAAgB,UAAhB;AACA,OAAOC,WAAP,MAAwB,sBAAxB;AACA,OAAOC,SAAP,MAAsB,oBAAtB;AACA,OAAOC,QAAP,MAAqB,oBAArB;AACA,OAAOC,GAAP,MAAgB,mBAAhB;AACA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,OAAOC,aAAP,MAA0B,SAA1B;AACA,SAAUC,cAAV,QAAgC,cAAhC;AACA,SAAUC,aAAV,QAA+B,UAA/B;AACA,OAAOC,OAAP,IAAkBC,UAAlB,QAAqC,kBAArC;AACA,SAASC,QAAT,QAAyB,UAAzB;AACA,OAAO,qBAAP;AACA,OAAO,oBAAP;;AAGA,MAAMC,KAAN,SAAoBb,GAApB,CAAwB;AAAA;AAAA;;AAAA,mCACd;AACNc,MAAAA,IAAI,EAAE,OADA;AAENF,MAAAA,QAAQ,EAAE;AAFJ,KADc;AAAA;;AAOtB,eAAaG,eAAb,CAA6B;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,GAA7B,EAAiD;AAC/C;AACA,cAAmC;AACjCC,MAAAA,MAAM,CAACC,SAAP,GAAmB,EAAnB;AACAD,MAAAA,MAAM,CAACC,SAAP,CAAiBC,SAAjB,GAA6B,EAA7B;AACAF,MAAAA,MAAM,CAACG,QAAP,GAAkB,EAAlB;AACD,KAN8C,CAO/C;AACA;;;AACA,UAAMC,SAAS,GAAGN,SAAS,CAACD,eAAV,GAA4B,MAAMC,SAAS,CAACD,eAAV,CAA0BE,GAA1B,CAAlC,GAAmE,EAArF;;AACA,UAAMM,UAAU,GAAG,WAAnB;;AACA,WAAO;AAAED,MAAAA,SAAF;AAAaC,MAAAA;AAAb,KAAP;AACD;;AAEDC,EAAAA,iBAAiB,GAAG;AAClB,UAAM;AAAEC,MAAAA;AAAF,QAAY,IAAlB;AACA,UAAM;AAAEC,MAAAA;AAAF,QAAYD,KAAlB;AACAE,IAAAA,MAAM,CAACC,KAAP,GAAeF,KAAf;AACAC,IAAAA,MAAM,CAACE,QAAP,GAAkBH,KAAK,CAACI,QAAxB;AACArB,IAAAA,aAAa;AACbC,IAAAA,OAAO,CACJC,UADH,GAEGoB,IAFH,CAEQ,MAAM;AACVL,MAAAA,KAAK,CAACI,QAAN,CAAevB,aAAa,EAA5B,EADU,CAEV;AACF,KALF,EAMGyB,OANH,CAMW,MAAM;AACb,WAAKC,QAAL,CAAc;AAAEC,QAAAA,YAAY,EAAE;AAAhB,OAAd;AACD,KARH;AASD;;AAEDC,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEnB,MAAAA,SAAF;AAAaM,MAAAA,SAAb;AAAwBI,MAAAA;AAAxB,QAAkC,KAAKD,KAA7C;AAEA,WACE,MAAC,aAAD;AAAe,MAAA,KAAK,EAAEC,KAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAEE,MAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAGE;AAAK,MAAA,KAAK,EAAE;AAAEU,QAAAA,QAAQ,EAAE;AAAZ,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,SAAD,eAAed,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OADF,CAHF,EAME,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,CADF;AAUD;;AAnDqB;;AAsDxB,eAAepB,SAAS,CAACD,WAAD,CAAT,CAAuBY,KAAvB,CAAf","sourcesContent":["import React from 'react'\nimport { Provider as ReduxProvider } from 'react-redux'\nimport App from 'next/app'\nimport createStore from '../redux/createStore'\nimport withRedux from 'next-redux-wrapper'\nimport HeadMeta from '../components/head'\nimport Nav from '../components/nav'\nimport Foot from '../components/foot'\nimport loginState from '../http/sessions'\nimport getPublicData from '../http'\nimport {  myNotification } from '../http/self'\nimport {  bindShortcuts } from '../utils'\nimport request, { getApiRoot  } from '../utils/request'\nimport { isMobile } from '~/utils'\nimport '../styles/main.scss'\nimport 'antd/dist/antd.css'\n\n\nclass MyApp extends App {\n  state = {\n    user: 'hello',\n    isMobile: false\n  }\n\n\n  static async getInitialProps({ Component, ctx }) {\n    // ctx 报错\n    if (typeof window === 'undefined') {\n      global.navigator = {}\n      global.navigator.languages = {}\n      global.location = {}\n    }\n    // const { req: { headers: { cookie } } } = ctx\n    // const locale = cookie.locale || 'zh'\n    const pageProps = Component.getInitialProps ? await Component.getInitialProps(ctx) : {}\n    const initialNow = Date.now()\n    return { pageProps, initialNow }\n  }\n\n  componentDidMount() {\n    const { props } = this\n    const { store } = props\n    window.STORE = store\n    window.DISPATCH = store.dispatch\n    bindShortcuts()\n    request\n      .getApiRoot()\n      .then(() => {\n        store.dispatch(getPublicData())\n        //store.dispatch(loginState()).then(() => store.dispatch(myNotification()))\n     })\n      .finally(() => {\n        this.setState({ initializing: false })\n      })\n  }\n\n  render() {\n    const { Component, pageProps, store } = this.props\n\n    return (\n      <ReduxProvider store={store}>\n        <HeadMeta />\n        <Nav />\n        <div style={{ position: 'relative' }}>\n          <Component {...pageProps} />\n        </div>\n        <Foot />\n      </ReduxProvider>\n    )\n  }\n}\n\nexport default withRedux(createStore)(MyApp)\n\n\n"]},"metadata":{},"sourceType":"module"}